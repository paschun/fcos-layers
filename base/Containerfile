ARG BASE_IMAGE=quay.io/fedora/fedora-coreos:stable
FROM ${BASE_IMAGE}

COPY policy.json /etc/containers/
COPY paschun.yaml /etc/containers/registries.d/
COPY paschun.pub /etc/pki/containers/

RUN <<EOF
set -xeuo pipefail
rpm-ostree install pv kitty fd-find ripgrep procs tree neovim bat man-db ranger btop et tmux tcpdump ldns-utils policycoreutils-python-utils qemu-guest-agent podman-tui restic rclone uv parted nmap-ncat buildah mtr inxi gdu 7zip strace xxhash fish
# this cleans up /var/cache among other things
ostree container commit
# do `bootc container lint --no-truncate --fatal-warnings` if base switches over to bootc
EOF

# https://coreos.github.io/rpm-ostree/container/#using-ostree-container-commit
